# Plant Trees機能 個別ビジュアルアップデート提案

## 概要
Dreamを消費して木を植える「Plant Trees（植林）」機能において、単にパッと木が出現する既存の挙動から、Dreamの神秘的な力を感じさせるリッチな演出へと変更する提案です。
**元のタイル背景（Dirtなど）は一切変更せず、その上にエフェクトを重ねる**方針で実装します。

## 1. 演出の構成（AとCの組み合わせ）
プレイヤーの要望に基づき、以下の3つのフェーズで構成される連携エフェクトを提案します。

### フェーズ1：魔法阵（光の予兆）の展開
*   **仕様:** ドラッグして確定した瞬間、システムが植林対象として選んだ各タイルの上に、うっすらと青白い魔法陣のようなテクスチャ（または円形の光の波紋）がフェードインします。
*   **目的:** どの場所に木が生えるかをプレイヤーに一瞬早く予告し、Dreamの力がその土地に集まりつつあることを表現します。
*   **実装:**
    *   一時的なエンティティに `SpriteBundle`（専用の魔法陣画像、加算合成BlendState）を持たせ、`Transform` のスケールを時間経過で大きくしながらAlpha値を下げて消滅させます。
    *   元のタイルエンティティは触りません。Z軸（`Z_ITEM_OBSTACLE`等のすぐ下）に配置します。

### フェーズ2：光の中からの急成長
*   **仕様:** 魔法陣が消えかかるタイミングで、木のシルエットが下から上へ（またはスケール0から1へ）フェードインしながら急成長します。この時、木全体を一瞬だけ青白く発光させます。
*   **目的:** 単なるデータの変更ではなく「Dreamの力で急激に育った」という生命力を表現します。
*   **実装:**
    *   木のスポーン時に専用の `TreeGrowthAnimation` コンポーネントを付与します。
    *   初期状態では `Transform::scale = Vec3::ZERO` または `Y` だけ小さい状態とし、数フレーム〜数十フレームかけて本来のサイズにTween（補間）させます。
    *   `Sprite::color` を一時的に `Color::rgba(0.5, 0.8, 1.0, 1.0)` のような青白さにし、成長完了と同調して白（`Color::WHITE`）にフェードさせます。

### フェーズ3：周囲への波及（生命力の拡散）
*   **仕様:** 木が成長しきった瞬間に、その木の根元を中心にして、周囲の土（ダート）の上に一瞬だけ青い光を帯びた草や花の明滅するパーティクル（光の粒や小さな葉のテクスチャ）がパッと円状に広がり、すっと地面に吸い込まれるように消えていきます。
*   **目的:** 対象タイルだけでなく、その周囲の環境そのものにDreamの生命力が一瞬だけ行き渡ったことを演出し、視覚的なフィードバックの範囲を広げます。
*   **実装:**
    *   木の成長完了イベント（またはタイマー満了時）をトリガーに、軽いパーティクルエフェクトシステムを呼び出します。
    *   パーティクルの発生源を木の根元とし、ランダムな方向へ短い距離だけ飛ばし、すぐにAlphaを0にしてデスポーンさせます。
    *   これも元のタイル情報（`world_map`）は一切書き換えません。純粋な視覚用の一時エンティティとして処理します。

## 実装ステップのドラフト
1.  **アセットの準備**：予兆用の円形/魔法陣テクスチャ（透過PNGなど）と、波及用の小さな光/葉のパーティクルテクスチャを用意・ロードする。
2.  **アニメーション・コンポーネントの追加**：`TreeVisualState` や `PlantingAnimationTimer` などを定義し、フェーズ進行を管理できるようにする。
3.  **既存ロジックへの組み込み**：`dream_tree_planting.rs` の即時スポーン処理を「エフェクトエミッターのスポーン」に置き換え、アニメーション進行に応じて最終的に木の実体を置く（または木自体を非アクティブな状態から段階的にアクティブにする）ように調整する。
4.  **演出の微調整**：フェードイン/アウトの速度、パーティクルの数、スケールの広がり方を実際に見ながらパラメータ調整する。

以上の内容で実装方針とさせていただき、よろしければ実装計画（Implementation Plan）を策定して実際のコーディング作業に入ります。
