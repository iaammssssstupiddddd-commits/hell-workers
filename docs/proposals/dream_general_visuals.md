# Dreamシステム全体 ビジュアルアップデート提案

## 概要
Soulが蓄積する「Dream（夢）」の獲得および消費に関する、UI・パーティクル双方のビジュアルフィードバックを強化する提案です。
本提案の目的は、プレイヤーに対して「Dreamが現在どれくらい溜まっているか」「正しく消費されたか」を視覚的に分かりやすくし、ゲームプレイの満足度を上げることです。

## 1. 獲得演出：UIへ向かって飛んでいくUIパーティクル
**【プレイヤー要望】**
> A　UIに向かって飛んでいく演出は理想だが、パフォーマンス上のボトルネックが発生しない形にしたい。また、UIは別座標なので実装が困難であれば諦める。

**【提案内容：軽量なUI上での軌跡演出（World->UIマッピング）】**
World座標で発生するパーティクルをUI座標系へ無理に追従させるのではなく、**「獲得した瞬間にUIレイヤー上で生成される光の粒」**として実装します。

*   **仕様:**
    1.  Dream獲得イベント発生時（例：一定量蓄積時やRestAreaからの定期獲得時）、該当するSoulまたはRestAreaの「画面上の位置（Screen Space）」を計算します。
    2.  その画面位置を始点として、BevyのUIノード（`NodeBundle` ＋ `ImageBundle` 等、または軽量なカスタム描画）を使って「光の粒」を生成します。
    3.  終点固定（右上のDream表示UIの座標）に向かって、ベジェ曲線などでフワッと飛んでいくアニメーションをUI更新システム（例: `Update` スケジュールのシステム）で処理します。
    4.  到達時にUIのテキストがピカッと光る（既存のパルス演出の強化）ことで獲得感を強調します。
*   **パフォーマンス対策:**
    *   **バッチ処理:** 個々のSoul単位で毎フレーム飛ばすのではなく、「Nポイント蓄積ごとに1つの大きな粒を飛ばす」「一定間隔（1秒ごとなど）にまとめて発生させる」ことでエンティティ数を制限します。
    *   とくにRestAreaからの獲得時は、RestArea単位で少数（1〜3個）の少し大きめな粒を飛ばす設計にします。
*   **実装の難易度について:**
    *   Cameraの`world_to_viewport`関数を使用することで、World座標（Soulの位置）からUI座標（画面上の位置）への変換は比較的容易に実装可能です。

## 2. 消費演出：UI上のリソース消費エフェクト
**【プレイヤー要望】**
> B　UI上にリソースの消費演出を入れたい。

**【提案内容：数値減少の可視化と波紋エフェクト】**
植林などでDreamを消費した際、ただ数値が減るだけでなく、「消費された」という手応えをUI上で表現します。

*   **仕様:**
    1.  **マイナスのポップアップ:** Dream消費時、元のUIテキストのすぐ下（または横）から、赤い文字または青白い文字で `-20.0` のような消費量がフワッと浮かび上がり、消えていく演出（Floating Text）。
    2.  **ゲージ/テキストへのショック効果:** 数値が減る瞬間に、UI要素全体が一瞬だけ少し沈み込む（スケールが小さくなる）か、赤・紫系の色でパルス発光するエフェクトをかけます。
    3.  **UIからの放出（オプション）:** 消費分に相当する光の粒が、右上のUIから「使用先（マウスカーソル位置や指定したエリア）」に向かってシュッと飛んでいく逆方向の軌跡演出。これも `viewport_to_world` 変換または画面内座標のみで表現可能です。

## 3. 空間・状態の演出（没入感の強化）
**【提案内容：Dreamモード切替時の画面効果】**
「Plant Trees」などのDream消費モードに入った際、通常の作業モードとは異なる特別な（夢の世界に干渉しているような）状態であることを示します。

*   **仕様:**
    1.  画面の四隅（周辺部）に、ごく薄い青白いヴィネット（Vignette）エフェクトのUIノードをオーバーレイ表示します（alpha値0.1〜0.2程度）。
    2.  モード中はこのヴィネットがゆっくりと明滅（呼吸するようなアニメーション）し、プレイヤーが神聖な力を使っている没入感を高めます。
    3.  モードをキャンセル（Escキーや右クリック）するとスッと消えます。

## 次のステップ
上記の方針でよろしければ、続いて「Plant Trees（植林）」個別の空間演出についての提案書を作成します。
（元のタイル背景を変えない、魔法の陣＋発芽＋周囲への波及エフェクトの方針）
